---
layout: post
title: "FEM Seminar 1 - FEM ê¸°ì´ˆ"
categories: [1. Computer Engineering, 2. Mathematics]
tags: [2.1. Pure mathematics, 2.1.1. Mathematical analysis, 2.1.2. Linear Algebra, 2.2. Applied Mathematics, 2.2.2. Mathematical Statistics, 2.2.1. Mathematical Optimization, 2.0. Paper Review]
---

## ğŸ“š ê³µë¶€ ì£¼ì œ: Reference Triangleê³¼ Affine Mappingì„ í™œìš©í•œ FEMì˜ ê¸°í•˜í•™ì  ëª¨ë¸ë§ êµ¬ì¡°

### 1. FEM(ìœ í•œ ìš”ì†Œë²•) ì´ë€?
FEM, ìœ í•œìš”ì†Œë²•ì€ ë³µì¡í•œ ê³µí•™ ë° ë¬´ë¦¬ ë¬¸ì œë¥¼ ì»´í“¨í„°ë¥¼ ì´ìš©í•´ ìˆ˜ì¹˜ì ìœ¼ë¡œ í•´ê²°í•˜ëŠ” ê°•ë ¥í•œ í•´ì„ ê¸°ë²•ì´ë‹¤. ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ” í˜ì˜ ì‘ìš©, ì—´ì˜ ì´ë™, ìœ ì²´ì˜ íë¦„ ë“± ì–´ë ¤ìš´ ë¯¸ë¶„ë°©ì •ì‹ìœ¼ë¡œ í‘œí˜„ë˜ëŠ” í˜„ìƒë“¤ì„ ëˆˆìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ì‹œë®¬ë ˆì´ì…˜í•˜ì—¬ ë³´ì—¬ì¤€ë‹¤.
  
í•µì‹¬ ì›ë¦¬ëŠ” **ë¶„í• ê³¼ ì •ë³µ**ì— ìˆë‹¤. í•´ì„í•˜ë ¤ëŠ” ë³µì¡í•œ í˜•ìƒì˜ ëŒ€ìƒë¬¼ì„ 'ìœ í•œ(Finite)'ê°œì˜ ë‹¨ìˆœí•œ ê¸°í•˜í•™ì  ëª¨ì–‘(ì‚¼ê°í˜•, ì‚¬ê°í˜• ë“±)ì¸ 'ìš”ì†Œ(Element)'ë¡œ ì˜ê²Œ ë‚˜ëˆ , ê° ìš”ì†Œì˜ ê±°ë™(ì›€ì§ì„)ì„ ë¹„êµì  ê°„ë‹¨í•œ ìˆ˜í•™ì  ê´€ê³„ë¡œ ê·¼ì‚¬í™”í•˜ì—¬ ê³„ì‚°í•˜ê³ , ì´ë¥¼ ì „ì²´ì ìœ¼ë¡œ **í†µí•©**í•˜ì—¬ ì˜ˆì¸¡í•˜ëŠ” ë°©ì‹ì´ë‹¤.

1. ë¶„í•  (Divide)
    * ì£¼ì–´ì§„ ë¬¸ì œë¥¼ ë” ì´ìƒ ë‚˜ëˆŒ ìˆ˜ ì—†ì„ ë•Œê¹Œì§€ ë¹„ìŠ·í•œ ìœ í˜•ì˜ ì—¬ëŸ¬ ì‘ì€ ë¬¸ì œë¡œ ìª¼ê° ë‹¤.

2. ì •ë³µ (Conquer)
    * ë‚˜ëˆ„ì–´ì§„ ì‘ì€ ë¬¸ì œë“¤ì€ í¬ê¸°ê°€ ì‘ê³  ë‹¨ìˆœí•˜ê¸° ë•Œë¬¸ì— í•´ê²°í•˜ê¸°ê°€ ì‰¬ì›Œ, ê° ë¬¸ì œë¥¼ ê°œë³„ì ìœ¼ë¡œ í•´ê²°í•œë‹¤.

3. í†µí•© (Combine)
    * í•´ê²°ëœ ì‘ì€ ë¬¸ì œë“¤ì˜ ë‹µì„ ë‹¤ì‹œ ì›ë˜ì˜ í° ë¬¸ì œì— ë§ê²Œ í•©ì³, ìµœì¢…ì ì¸ í•´ë‹µì„ ì–»ëŠ”ë‹¤.

### 2. í•µì‹¬ í‚¤ì›Œë“œ ì„¤ëª…
* ê·¼ì‚¬ í•´ : $u_h = \sum^{DOF}_{i=1}\alpha_{i}\psi_{i}$
    * $u_{h}$: FEMìœ¼ë¡œ ê³„ì‚°ëœ **ê·¼ì‚¬ í•´ (approximate solution)**. ì‹¤ì œ í•´ $u$ë¥¼ ì™„ë²½í•˜ê²Œ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, $u$ ëŒ€ì‹  $u_{h}$ë¡œ ê³„ì‚°.

    * $\alpha_{i}$ : **í•´ì˜ ê³„ìˆ˜ (ë˜ëŠ” ììœ ë„ ê°’, DOF ê°’)**. ì´ ê°’ì€ FEM í•´ì„ ê³¼ì •ì—ì„œ ê³„ì‚°ë˜ëŠ” ìˆ˜ì¹˜ ê²°ê³¼(ë³€ìˆ˜). ì˜ˆ: ë³€ìœ„, ì˜¨ë„ ë“±

    * $\psi_{i}$ : **ê¸°ì € í•¨ìˆ˜(basis function)** ë˜ëŠ” **í˜•ìƒ í•¨ìˆ˜(shape function)**. ê° ìš”ì†Œë‚˜ ë…¸ë“œì—ì„œ í•´ë¥¼ ê·¼ì‚¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜.

    * $DOF$ : ì „ì²´ ì‹œìŠ¤í…œì—ì„œì˜ ììœ ë„(Degree of Freedom) ê°œìˆ˜. FEM ì‹œìŠ¤í…œì˜ ë³€ìˆ˜ ê°œìˆ˜ë¡œ ì‚¬ìš©.

    * ì‹ì˜ ì˜ë¯¸ : FEMì€ í•´ $u(x)$ë¥¼ ì •í™•íˆ êµ¬í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, ê¸°ì € í•¨ìˆ˜ë“¤ì˜ ì„ í˜• ê²°í•©ìœ¼ë¡œ ê·¼ì‚¬í•œë‹¤. ì¦‰, $u_h(x) = \alpha_1 \psi_1(x) + \alpha_2 \psi_2(x) + \cdots + \alpha_n \psi_n(x)$ ì´ì²˜ëŸ¼ $\psi_{i}(x)$ë¼ëŠ” ê°„ë‹¨í•œ í•¨ìˆ˜ë“¤ì„ ì—¬ëŸ¬ ê°œ í•©ì³ì„œ, ë³µì¡í•œ í•´ $u(x)$ë¥¼ ê·¼ì‚¬í•œë‹¤.

* Reference Triangle, $T_{R}$ : 

* Physical Triangle, $T_{P}$ :

### 3. 1ì°¨ ì„ í˜• ìš”ì†Œì˜ í•´

* 1ì°¨ ì„ í˜• ìš”ì†Œë€?
    * ìš”ì†Œ(Element)ë€?
        * FEMì—ì„œ ë³µì¡í•œ ì—°ì†ì²´(ì˜ˆ: êµ¬ì¡°ë¬¼, ê¸°ê³„ë¶€í’ˆ, ë¼ˆ, ë‚ ê°œ ë“±)ë¥¼ ì‘ì€ ì¡°ê°ë“¤ë¡œ ë¶„í• í•´ì„œ ë¶„ì„í•  ë•Œ, ì‘ì€ ì¡°ê° í•˜ë‚˜í•˜ë‚˜ë¥¼ **ìš”ì†Œ(Element)** ë¼ê³  ë¶€ë¥¸ë‹¤.
    * ê° ì°¨ì›ì—ì„œì˜ ìš”ì†ŒëŠ”?
        * 1ì°¨ì› -> ì„ ë¶„(line segment or line element or linear element)
            * ë‘ ë…¸ë“œë¡œ êµ¬ì„±ëœ 1ì°¨ì› ìš”ì†Œ
        * 2ì°¨ì› -> ì‚¼ê°í˜•(triangular element) / ì‚¬ê°í˜•(quadrilateral element)
            * ì„¸ ë…¸ë“œë¡œ êµ¬ì„±ëœ í‰ë©´ ìš”ì†Œ / ë„¤ ë…¸ë“œë¡œ êµ¬ì„±ëœ í‰ë©´ ìš”ì†Œ
        * 3ì°¨ì› -> ì‚¬ë©´ì²´(tetrahedral element) / ìœ¡ë©´ì²´(hexahedral element or brick element)
            * ë„¤ ê¼­ì§“ì ì˜ 3D ìš”ì†Œ / 
    * íŠ¹ì§•
        * **ê¸°ì € í•¨ìˆ˜(basis function)** ë˜ëŠ” **í˜•ìƒ í•¨ìˆ˜(shape function)** ê°€ 1ì°¨ ë‹¤í•­ì‹
        * ê° ìš”ì†Œì—ëŠ” **ë…¸ë“œ(Node)**ê°€ 2ê°œë§Œ ìˆìŒ
        * í•´ëŠ” ë‘ ë…¸ë“œ ì‚¬ì´ë¥¼ **ì§ì„ ìœ¼ë¡œ ì—°ê²°**í•´ì„œ ë³´ê°„
    * ìˆ˜ì‹ í‘œí˜„
        * ìš”ì†Œ êµ¬ê°„ : $x\in[0,1]$
            * ìš”ì†Œ êµ¬ê°„ì´ $[0, 1]$ì¸ ì´ìœ 
                * ì •ê·œ ì¢Œí‘œê³„(natural coordinate)ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´
                * ì‹¤ì œ ìš”ì†Œ êµ¬ê°„ì´ [2, 5]ì¼ì§€ë¼ë„, ì •ê·œ ì¢Œí‘œê³„ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ëª¨ë“  ìš”ì†Œë¥¼ **ë™ì¼í•˜ê²Œ í•´ì„**í•  ìˆ˜ ìˆê³ , í•œ ë²ˆ ì •ì˜í•œ í˜•ìƒ í•¨ìˆ˜ ë° ì ë¶„ ë“±ì˜ ê³„ì‚°ì„ ëª¨ë“  ìš”ì†Œì— **ì¬ì‚¬ìš©** ê°€ëŠ¥í•˜ë‹¤.
                * ì‹¤ì œ ìš”ì†Œ êµ¬ê°„(ì‹¤ì œ ì¢Œí‘œê³„, physical coordinates)ì„ ì •ê·œí™”ëœ ìš”ì†Œ êµ¬ê°„ $\hat{x}\in[0,1]$ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ë‹¨ìˆœí•˜ê²Œ í•´ì„í•œë‹¤.
                    * ì‹¤ì œ ìš”ì†Œ -> ì •ê·œí™”ëœ ìš”ì†Œ : $x = \alpha + (b - a)\hat{x}$
                    * ì •ê·œí™”ëœ ìš”ì†Œ -> ì‹¤ì œ ìš”ì†Œ : $\hat{x} = (x - a) / (b - a)$
        * $u_{h}(x) = \sum^{2}_{i=1}\alpha_{i}\psi_{i} = \alpha_{1}\psi_{1}(x) + \alpha_{2}\psi_{2}(x)$

``` python
import numpy as np
import matplotlib.pyplot as plt

# ë…¸ë“œ ìœ„ì¹˜
x = np.linspace(0, 1, 100)

# ê³„ìˆ˜ (ììœ ë„ ê°’)
alpha1 = 2
alpha2 = 5

# í˜•ìƒ í•¨ìˆ˜
psi1 = 1 - x
psi2 = x

# ê·¼ì‚¬ í•´
u_h = alpha1 * psi1 + alpha2 * psi2

# ì‹œê°í™”
plt.plot(x, psi1, '--', label='Ïˆâ‚(x) = 1 - x')
plt.plot(x, psi2, '--', label='Ïˆâ‚‚(x) = x')
plt.plot(x, u_h, label='uâ‚•(x) = Î±â‚Ïˆâ‚ + Î±â‚‚Ïˆâ‚‚', linewidth=2)
plt.scatter([0, 1], [alpha1, alpha2], c='red', zorder=5, label='ë…¸ë“œ ê°’ (Î±â‚, Î±â‚‚)')

# plt.title('1ì°¨ ì„ í˜• ìš”ì†Œì˜ FEM ê·¼ì‚¬ í•´ ì‹œê°í™”')
plt.title('Visualization of FEM Approximation with Linear Elements')
plt.xlabel('x')
plt.ylabel('uâ‚•(x)')
plt.legend()
plt.grid(True)
plt.show()
```




### 4. ì ìš© ì˜ˆì‹œ
- ë¶ˆê· í˜• ë°ì´í„°ì…‹ì—ì„œëŠ” Precisionë³´ë‹¤ Recallì´ ì¤‘ìš”í•  ìˆ˜ ìˆìŒ (ì˜ˆ: ìŠ¤íŒ¸ íƒì§€)

### 5. ëŠë‚€ ì  ë° ë‹¤ìŒ ê³„íš
- ëª¨ë¸ì„ ë¹„êµí•  ë•ŒëŠ” í•˜ë‚˜ì˜ ì§€í‘œë¡œ íŒë‹¨í•˜ì§€ ë§ ê²ƒ
- ë‹¤ìŒì—ëŠ” ROC Curve ì§ì ‘ ê·¸ë ¤ë³´ê¸°
